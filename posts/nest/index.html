<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Nest | yassine</title><meta name="generator" content="Jekyll v3.8.3" /><meta property="og:title" content="Nest" /><meta name="author" content="Mohammad YASSINE" /><meta property="og:locale" content="en_US" /><meta name="description" content="Nest from HackTheBox" /><meta property="og:description" content="Nest from HackTheBox" /><link rel="canonical" href="https://0xyassine.github.io//posts/nest/" /><meta property="og:url" content="https://0xyassine.github.io//posts/nest/" /><meta property="og:site_name" content="yassine" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-05T00:00:00+03:00" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Nest from HackTheBox","url":"https://0xyassine.github.io//posts/nest/","headline":"Nest","dateModified":"2020-06-05T00:00:00+03:00","datePublished":"2020-06-05T00:00:00+03:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xyassine.github.io//posts/nest/"},"author":{"@type":"Person","name":"Mohammad YASSINE"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/main.css"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="style" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/syntax.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/syntax.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">yassine</a></div><div id="site-subtitle" class="font-italic">Pentester | CyberSec analyst .</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://www.facebook.com/mouhamed.yassin.90" target="_blank"> <i class="fab fa-facebook-alt"><b><font color="orange">F</font></b></i> </a> <a href="https://www.linkedin.com/in/mohammad-yassine-8b84041a5/" target="_blank"> <i class="fab fa-linked-alt"><b><font color="orange">L</font></b></i> </a> <a href="https://www.hackthebox.eu/home/users/profile/143843" target="_blank"> <i class="fab fa-linked-alt"><b><font color="orange">H</font></b></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Nest</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Nest</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Fri, Jun 5, 2020, 12:00 AM +0300"> Jun 5, 2020 <i class="unloaded">2020-06-05T00:00:00+03:00</i> </span> by <span class="author"> Mohammad YASSINE </span></div></div><div class="post-content"><h1 id="nest-from-hackthebox">Nest from HackTheBox</h1><p><br /></p><p><img class="lozad" src= /assets/img/commons/loading.png data-src="https://raw.githubusercontent.com/0xyassine/0xyassine.github.io/master/assets/img/htb/nest/info.jpg" alt="info" /></p><p><br /> Nest was an easy Windows box from HackTheBox .<br /> I enumerated using kali and hacked into this box using Windows … <br /></p><h2 id="nmap-scan">nmap scan</h2><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap -sV -sC 10.10.10.178 -v
</pre></table></code></div></div><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="go">PORT    STATE SERVICE       VERSION
445/tcp open  microsoft-ds?

Host script results:
|_clock-skew: 3m43s
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-06-05T18:27:03
|_  start_date: 2020-06-05T18:25:22

NSE: Script Post-scanning.
</span></pre></table></code></div></div><p>Nmap show only microsoft port open , it’s a <code class="highlighter-rouge">smb</code> service . <br /></p><h2 id="enumeration">Enumeration</h2><p>First thing to do in this case is to check for anonymous login . <br /></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smbclient -L 10.10.10.178 -U anonymous
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Enter WORKGROUP\anonymous's password: 

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	Data            Disk      
	IPC$            IPC       Remote IPC
	Secure$         Disk      
	Users           Disk      
SMB1 disabled -- no workgroup available
</pre></table></code></div></div><p>By checking the <code class="highlighter-rouge">Data</code> , i was able to find three folders <br /> Enumerating folders recursively:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smbclient  //10.10.10.178/data -U anonymous -c 'recurse;ls'
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre>Enter WORKGROUP\anonymous's password: 
  .                                   D        0  Thu Aug  8 01:53:46 2019
  ..                                  D        0  Thu Aug  8 01:53:46 2019
  IT                                  D        0  Thu Aug  8 01:58:07 2019
  Production                          D        0  Tue Aug  6 00:53:38 2019
  Reports                             D        0  Tue Aug  6 00:53:44 2019
  Shared                              D        0  Wed Aug  7 22:07:51 2019

\IT
NT_STATUS_ACCESS_DENIED listing \IT\*

\Production
NT_STATUS_ACCESS_DENIED listing \Production\*

\Reports
NT_STATUS_ACCESS_DENIED listing \Reports\*

\Shared
  .                                   D        0  Wed Aug  7 22:07:51 2019
  ..                                  D        0  Wed Aug  7 22:07:51 2019
  Maintenance                         D        0  Wed Aug  7 22:07:32 2019
  Templates                           D        0  Wed Aug  7 22:08:07 2019

\Shared\Maintenance
  .                                   D        0  Wed Aug  7 22:07:32 2019
  ..                                  D        0  Wed Aug  7 22:07:32 2019
  Maintenance Alerts.txt              A       48  Tue Aug  6 02:01:44 2019

\Shared\Templates
  .                                   D        0  Wed Aug  7 22:08:07 2019
  ..                                  D        0  Wed Aug  7 22:08:07 2019
  HR                                  D        0  Wed Aug  7 22:08:01 2019
  Marketing                           D        0  Wed Aug  7 22:08:06 2019

\Shared\Templates\HR
  .                                   D        0  Wed Aug  7 22:08:01 2019
  ..                                  D        0  Wed Aug  7 22:08:01 2019
  Welcome Email.txt                   A      425  Thu Aug  8 01:55:36 2019

\Shared\Templates\Marketing
  .                                   D        0  Wed Aug  7 22:08:06 2019
  ..                                  D        0  Wed Aug  7 22:08:06 2019
</pre></table></code></div></div><p>I got access denied but also got two <code class="highlighter-rouge">txt</code> files<br /></p><p><code class="highlighter-rouge">Maintenance Alerts.txt</code></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>There is currently no scheduled maintenance work
</pre></table></code></div></div><p><code class="highlighter-rouge">Welcome Email.txt</code></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>We would like to extend a warm welcome to our newest member of staff, &lt;FIRSTNAME&gt; &lt;SURNAME&gt;

You will find your home folder in the following location: 
\\HTB-NEST\Users\&lt;USERNAME&gt;

If you have any issues accessing specific services or workstations, please inform the 
IT department and use the credentials below until all systems have been set up for you.

Username: TempUser
Password: welcome2019


Thank you
HR
</pre></table></code></div></div><p>Now i have a <code class="highlighter-rouge">username</code> and <code class="highlighter-rouge">password</code> now . <br /> Those creds will allow me to access more services or workstations as mentioned in this email. <br /> Repeating the same steps but with <code class="highlighter-rouge">TempUser</code></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smbclient  //10.10.10.178/data -U TempUser -c 'recurse;ls'
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
</pre><td class="rouge-code"><pre>Enter WORKGROUP\TempUser's password: 
  .                                   D        0  Thu Aug  8 01:53:46 2019
  ..                                  D        0  Thu Aug  8 01:53:46 2019
  IT                                  D        0  Thu Aug  8 01:58:07 2019
  Production                          D        0  Tue Aug  6 00:53:38 2019
  Reports                             D        0  Tue Aug  6 00:53:44 2019
  Shared                              D        0  Wed Aug  7 22:07:51 2019

\IT
  .                                   D        0  Thu Aug  8 01:58:07 2019
  ..                                  D        0  Thu Aug  8 01:58:07 2019
  Archive                             D        0  Tue Aug  6 01:33:58 2019
  Configs                             D        0  Thu Aug  8 01:59:34 2019
  Installs                            D        0  Thu Aug  8 01:08:30 2019
  Reports                             D        0  Sun Jan 26 02:09:13 2020
  Tools                               D        0  Tue Aug  6 01:33:43 2019

\Production
  .                                   D        0  Tue Aug  6 00:53:38 2019
  ..                                  D        0  Tue Aug  6 00:53:38 2019

\Reports
  .                                   D        0  Tue Aug  6 00:53:44 2019
  ..                                  D        0  Tue Aug  6 00:53:44 2019

\Shared
  .                                   D        0  Wed Aug  7 22:07:51 2019
  ..                                  D        0  Wed Aug  7 22:07:51 2019
  Maintenance                         D        0  Wed Aug  7 22:07:32 2019
  Templates                           D        0  Wed Aug  7 22:08:07 2019

\IT\Archive
  .                                   D        0  Tue Aug  6 01:33:58 2019
  ..                                  D        0  Tue Aug  6 01:33:58 2019

\IT\Configs
  .                                   D        0  Thu Aug  8 01:59:34 2019
  ..                                  D        0  Thu Aug  8 01:59:34 2019
  Adobe                               D        0  Wed Aug  7 22:20:09 2019
  Atlas                               D        0  Tue Aug  6 14:16:18 2019
  DLink                               D        0  Tue Aug  6 16:25:27 2019
  Microsoft                           D        0  Wed Aug  7 22:23:26 2019
  NotepadPlusPlus                     D        0  Wed Aug  7 22:31:37 2019
  RU Scanner                          D        0  Wed Aug  7 23:01:13 2019
  Server Manager                      D        0  Tue Aug  6 16:25:19 2019

\IT\Installs
  .                                   D        0  Thu Aug  8 01:08:30 2019
  ..                                  D        0  Thu Aug  8 01:08:30 2019

\IT\Reports
  .                                   D        0  Sun Jan 26 02:09:13 2020
  ..                                  D        0  Sun Jan 26 02:09:13 2020

\IT\Tools
  .                                   D        0  Tue Aug  6 01:33:43 2019
  ..                                  D        0  Tue Aug  6 01:33:43 2019

\Shared\Maintenance
  .                                   D        0  Wed Aug  7 22:07:32 2019
  ..                                  D        0  Wed Aug  7 22:07:32 2019
  Maintenance Alerts.txt              A       48  Tue Aug  6 02:01:44 2019

\Shared\Templates
  .                                   D        0  Wed Aug  7 22:08:07 2019
  ..                                  D        0  Wed Aug  7 22:08:07 2019
  HR                                  D        0  Wed Aug  7 22:08:01 2019
  Marketing                           D        0  Wed Aug  7 22:08:06 2019

\IT\Configs\Adobe
  .                                   D        0  Wed Aug  7 22:20:09 2019
  ..                                  D        0  Wed Aug  7 22:20:09 2019
  editing.xml                        AH      246  Sat Aug  3 15:58:42 2019
  Options.txt                         A        0  Tue Oct 11 00:11:14 2011
  projects.xml                        A      258  Tue Jan  8 18:30:52 2013
  settings.xml                        A     1274  Wed Aug  7 22:19:12 2019

\IT\Configs\Atlas
  .                                   D        0  Tue Aug  6 14:16:18 2019
  ..                                  D        0  Tue Aug  6 14:16:18 2019
  Temp.XML                            A     1369  Wed Jun 11 10:38:22 2003

\IT\Configs\DLink
  .                                   D        0  Tue Aug  6 16:25:27 2019
  ..                                  D        0  Tue Aug  6 16:25:27 2019

\IT\Configs\Microsoft
  .                                   D        0  Wed Aug  7 22:23:26 2019
  ..                                  D        0  Wed Aug  7 22:23:26 2019
  Options.xml                         A     4598  Sat Mar  3 21:24:24 2012

\IT\Configs\NotepadPlusPlus
  .                                   D        0  Wed Aug  7 22:31:37 2019
  ..                                  D        0  Wed Aug  7 22:31:37 2019
  config.xml                          A     6451  Thu Aug  8 02:01:25 2019
  shortcuts.xml                       A     2108  Wed Aug  7 22:30:27 2019

\IT\Configs\RU Scanner
  .                                   D        0  Wed Aug  7 23:01:13 2019
  ..                                  D        0  Wed Aug  7 23:01:13 2019
  RU_config.xml                       A      270  Thu Aug  8 22:49:37 2019

\IT\Configs\Server Manager
  .                                   D        0  Tue Aug  6 16:25:19 2019
  ..                                  D        0  Tue Aug  6 16:25:19 2019

\Shared\Templates\HR
  .                                   D        0  Wed Aug  7 22:08:01 2019
  ..                                  D        0  Wed Aug  7 22:08:01 2019
  Welcome Email.txt                   A      425  Thu Aug  8 01:55:36 2019

\Shared\Templates\Marketing
  .                                   D        0  Wed Aug  7 22:08:06 2019
  ..                                  D        0  Wed Aug  7 22:08:06 2019

		10485247 blocks of size 4096. 6543374 blocks available
</pre></table></code></div></div><p>New <code class="highlighter-rouge">xml</code> files appear , two files seem interesting : <code class="highlighter-rouge">config.xml</code> and <code class="highlighter-rouge">RU_config.xml</code></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>smbclient  //10.10.10.178/data -U TempUser
cd \IT\Configs\NotepadPlusPlus
get "config.xml"
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="Windows-1252" ?&gt;</span>
<span class="nt">&lt;NotepadPlus&gt;</span>
    <span class="nt">&lt;GUIConfigs&gt;</span>
        <span class="c">&lt;!-- 3 status : "large", "small" or "hide"--&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"ToolBar"</span> <span class="na">visible=</span><span class="s">"yes"</span><span class="nt">&gt;</span>standard<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="c">&lt;!-- 2 status : "show" or "hide"--&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"StatusBar"</span><span class="nt">&gt;</span>show<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="c">&lt;!-- For all attributs, 2 status : "yes" or "no"--&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"TabBar"</span> <span class="na">dragAndDrop=</span><span class="s">"yes"</span> <span class="na">drawTopBar=</span><span class="s">"yes"</span> <span class="na">drawInactiveTab=</span><span class="s">"yes"</span> <span class="na">reduce=</span><span class="s">"yes"</span> <span class="na">closeButton=</span><span class="s">"no"</span> <span class="na">doubleClick2Close=</span><span class="s">"no"</span> <span class="na">vertical=</span><span class="s">"no"</span> <span class="na">multiLine=</span><span class="s">"no"</span> <span class="na">hide=</span><span class="s">"no"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- 2 positions : "horizontal" or "vertical"--&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"ScintillaViewsSplitter"</span><span class="nt">&gt;</span>vertical<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="c">&lt;!-- For the attribut of position, 2 status : docked or undocked ; 2 status : "show" or "hide" --&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"UserDefineDlg"</span> <span class="na">position=</span><span class="s">"undocked"</span><span class="nt">&gt;</span>hide<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"TabSetting"</span> <span class="na">size=</span><span class="s">"4"</span> <span class="na">replaceBySpace=</span><span class="s">"no"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!--App position--&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"AppPosition"</span> <span class="na">x=</span><span class="s">"662"</span> <span class="na">y=</span><span class="s">"95"</span> <span class="na">width=</span><span class="s">"955"</span> <span class="na">height=</span><span class="s">"659"</span> <span class="na">isMaximized=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- For the primary scintilla view,
             2 status for Attribut lineNumberMargin, bookMarkMargin, indentGuideLine and currentLineHilitingShow: "show" or "hide"
             4 status for Attribut folderMarkStyle : "simple", "arrow", "circle" and "box"  --&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"ScintillaPrimaryView"</span> <span class="na">lineNumberMargin=</span><span class="s">"show"</span> <span class="na">bookMarkMargin=</span><span class="s">"show"</span> <span class="na">folderMarkStyle=</span><span class="s">"box"</span> <span class="na">indentGuideLine=</span><span class="s">"show"</span> <span class="na">currentLineHilitingShow=</span><span class="s">"show"</span> <span class="na">Wrap=</span><span class="s">"yes"</span> <span class="na">edge=</span><span class="s">"no"</span> <span class="na">edgeNbColumn=</span><span class="s">"100"</span> <span class="na">wrapSymbolShow=</span><span class="s">"hide"</span> <span class="na">zoom=</span><span class="s">"0"</span> <span class="na">whiteSpaceShow=</span><span class="s">"hide"</span> <span class="na">eolShow=</span><span class="s">"hide"</span> <span class="na">lineWrapMethod=</span><span class="s">"aligned"</span> <span class="na">zoom2=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- For the secodary scintilla view,
             2 status for Attribut lineNumberMargin, bookMarkMargin, indentGuideLine and currentLineHilitingShow: "show" or "hide"
             4 status for Attribut folderMarkStyle : "simple", "arrow", "circle" and "box" --&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"Auto-detection"</span><span class="nt">&gt;</span>yes<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"CheckHistoryFiles"</span><span class="nt">&gt;</span>no<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"TrayIcon"</span><span class="nt">&gt;</span>no<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"RememberLastSession"</span><span class="nt">&gt;</span>yes<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="c">&lt;!--
			New Document default settings :
				format = 0/1/2 -&gt; win/unix/mac
				encoding = 0/1/2/3/4/5 -&gt; ANSI/UCS2Big/UCS2small/UTF8/UTF8-BOM
				defaultLang = 0/1/2/..

			Note 1 : UTF8-BOM -&gt; UTF8 without BOM
			Note 2 : for defaultLang :
					0 -&gt; L_TXT
					1 -&gt; L_PHP
					... (see source file)
		--&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"NewDocDefaultSettings"</span> <span class="na">format=</span><span class="s">"0"</span> <span class="na">encoding=</span><span class="s">"0"</span> <span class="na">lang=</span><span class="s">"0"</span> <span class="na">codepage=</span><span class="s">"-1"</span> <span class="na">openAnsiAsUTF8=</span><span class="s">"no"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"langsExcluded"</span> <span class="na">gr0=</span><span class="s">"0"</span> <span class="na">gr1=</span><span class="s">"0"</span> <span class="na">gr2=</span><span class="s">"0"</span> <span class="na">gr3=</span><span class="s">"0"</span> <span class="na">gr4=</span><span class="s">"0"</span> <span class="na">gr5=</span><span class="s">"0"</span> <span class="na">gr6=</span><span class="s">"0"</span> <span class="na">gr7=</span><span class="s">"0"</span> <span class="na">langMenuCompact=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!--
		printOption is print colour setting, the following values are possible :
			0 : WYSIWYG
			1 : Invert colour
			2 : B &amp; W
			3 : WYSIWYG but without background colour
		--&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"Print"</span> <span class="na">lineNumber=</span><span class="s">"no"</span> <span class="na">printOption=</span><span class="s">"0"</span> <span class="na">headerLeft=</span><span class="s">"$(FULL_CURRENT_PATH)"</span> <span class="na">headerMiddle=</span><span class="s">""</span> <span class="na">headerRight=</span><span class="s">"$(LONG_DATE) $(TIME)"</span> <span class="na">headerFontName=</span><span class="s">"IBMPC"</span> <span class="na">headerFontStyle=</span><span class="s">"1"</span> <span class="na">headerFontSize=</span><span class="s">"8"</span> <span class="na">footerLeft=</span><span class="s">""</span> <span class="na">footerMiddle=</span><span class="s">"-$(CURRENT_PRINTING_PAGE)-"</span> <span class="na">footerRight=</span><span class="s">""</span> <span class="na">footerFontName=</span><span class="s">""</span> <span class="na">footerFontStyle=</span><span class="s">"0"</span> <span class="na">footerFontSize=</span><span class="s">"9"</span> <span class="na">margeLeft=</span><span class="s">"0"</span> <span class="na">margeTop=</span><span class="s">"0"</span> <span class="na">margeRight=</span><span class="s">"0"</span> <span class="na">margeBottom=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!--
                            Backup Setting :
                                0 : non backup
                                1 : simple backup
                                2 : verbose backup
                      --&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"Backup"</span> <span class="na">action=</span><span class="s">"0"</span> <span class="na">useCustumDir=</span><span class="s">"no"</span> <span class="na">dir=</span><span class="s">""</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"TaskList"</span><span class="nt">&gt;</span>yes<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"SaveOpenFileInSameDir"</span><span class="nt">&gt;</span>no<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"noUpdate"</span> <span class="na">intervalDays=</span><span class="s">"15"</span> <span class="na">nextUpdateDate=</span><span class="s">"20080426"</span><span class="nt">&gt;</span>no<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"MaitainIndent"</span><span class="nt">&gt;</span>yes<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"MRU"</span><span class="nt">&gt;</span>yes<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"URL"</span><span class="nt">&gt;</span>0<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"globalOverride"</span> <span class="na">fg=</span><span class="s">"no"</span> <span class="na">bg=</span><span class="s">"no"</span> <span class="na">font=</span><span class="s">"no"</span> <span class="na">fontSize=</span><span class="s">"no"</span> <span class="na">bold=</span><span class="s">"no"</span> <span class="na">italic=</span><span class="s">"no"</span> <span class="na">underline=</span><span class="s">"no"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"auto-completion"</span> <span class="na">autoCAction=</span><span class="s">"0"</span> <span class="na">triggerFromNbChar=</span><span class="s">"1"</span> <span class="na">funcParams=</span><span class="s">"no"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"sessionExt"</span><span class="nt">&gt;&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"SmartHighLight"</span><span class="nt">&gt;</span>yes<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"TagsMatchHighLight"</span> <span class="na">TagAttrHighLight=</span><span class="s">"yes"</span> <span class="na">HighLightNonHtmlZone=</span><span class="s">"no"</span><span class="nt">&gt;</span>yes<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"MenuBar"</span><span class="nt">&gt;</span>show<span class="nt">&lt;/GUIConfig&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"Caret"</span> <span class="na">width=</span><span class="s">"1"</span> <span class="na">blinkRate=</span><span class="s">"250"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"ScintillaGlobalSettings"</span> <span class="na">enableMultiSelection=</span><span class="s">"no"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"openSaveDir"</span> <span class="na">value=</span><span class="s">"0"</span> <span class="na">defaultDirPath=</span><span class="s">""</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"titleBar"</span> <span class="na">short=</span><span class="s">"no"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;GUIConfig</span> <span class="na">name=</span><span class="s">"DockingManager"</span> <span class="na">leftWidth=</span><span class="s">"200"</span> <span class="na">rightWidth=</span><span class="s">"200"</span> <span class="na">topHeight=</span><span class="s">"200"</span> <span class="na">bottomHeight=</span><span class="s">"266"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;FloatingWindow</span> <span class="na">cont=</span><span class="s">"4"</span> <span class="na">x=</span><span class="s">"39"</span> <span class="na">y=</span><span class="s">"109"</span> <span class="na">width=</span><span class="s">"531"</span> <span class="na">height=</span><span class="s">"364"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;PluginDlg</span> <span class="na">pluginName=</span><span class="s">"dummy"</span> <span class="na">id=</span><span class="s">"0"</span> <span class="na">curr=</span><span class="s">"3"</span> <span class="na">prev=</span><span class="s">"-1"</span> <span class="na">isVisible=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;PluginDlg</span> <span class="na">pluginName=</span><span class="s">"NppConverter.dll"</span> <span class="na">id=</span><span class="s">"3"</span> <span class="na">curr=</span><span class="s">"4"</span> <span class="na">prev=</span><span class="s">"0"</span> <span class="na">isVisible=</span><span class="s">"no"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;ActiveTabs</span> <span class="na">cont=</span><span class="s">"0"</span> <span class="na">activeTab=</span><span class="s">"-1"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;ActiveTabs</span> <span class="na">cont=</span><span class="s">"1"</span> <span class="na">activeTab=</span><span class="s">"-1"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;ActiveTabs</span> <span class="na">cont=</span><span class="s">"2"</span> <span class="na">activeTab=</span><span class="s">"-1"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;ActiveTabs</span> <span class="na">cont=</span><span class="s">"3"</span> <span class="na">activeTab=</span><span class="s">"-1"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/GUIConfig&gt;</span>
    <span class="nt">&lt;/GUIConfigs&gt;</span>
    <span class="c">&lt;!-- The History of opened files list --&gt;</span>
    <span class="nt">&lt;FindHistory</span> <span class="na">nbMaxFindHistoryPath=</span><span class="s">"10"</span> <span class="na">nbMaxFindHistoryFilter=</span><span class="s">"10"</span> <span class="na">nbMaxFindHistoryFind=</span><span class="s">"10"</span> <span class="na">nbMaxFindHistoryReplace=</span><span class="s">"10"</span> <span class="na">matchWord=</span><span class="s">"no"</span> <span class="na">matchCase=</span><span class="s">"no"</span> <span class="na">wrap=</span><span class="s">"yes"</span> <span class="na">directionDown=</span><span class="s">"yes"</span> <span class="na">fifRecuisive=</span><span class="s">"yes"</span> <span class="na">fifInHiddenFolder=</span><span class="s">"no"</span> <span class="na">dlgAlwaysVisible=</span><span class="s">"no"</span> <span class="na">fifFilterFollowsDoc=</span><span class="s">"no"</span> <span class="na">fifFolderFollowsDoc=</span><span class="s">"no"</span> <span class="na">searchMode=</span><span class="s">"0"</span> <span class="na">transparencyMode=</span><span class="s">"0"</span> <span class="na">transparency=</span><span class="s">"150"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Find</span> <span class="na">name=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Find</span> <span class="na">name=</span><span class="s">"txt"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Find</span> <span class="na">name=</span><span class="s">"itx"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Find</span> <span class="na">name=</span><span class="s">"iTe"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Find</span> <span class="na">name=</span><span class="s">"IEND"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Find</span> <span class="na">name=</span><span class="s">"redeem"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Find</span> <span class="na">name=</span><span class="s">"activa"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Find</span> <span class="na">name=</span><span class="s">"activate"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Find</span> <span class="na">name=</span><span class="s">"redeem on"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Find</span> <span class="na">name=</span><span class="s">"192"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Replace</span> <span class="na">name=</span><span class="s">"C_addEvent"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/FindHistory&gt;</span>
    <span class="nt">&lt;History</span> <span class="na">nbMaxFile=</span><span class="s">"15"</span> <span class="na">inSubMenu=</span><span class="s">"no"</span> <span class="na">customLength=</span><span class="s">"-1"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;File</span> <span class="na">filename=</span><span class="s">"C:\windows\System32\drivers\etc\hosts"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;File</span> <span class="na">filename=</span><span class="s">"\\HTB-NEST\Secure$\IT\Carl\Temp.txt"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;File</span> <span class="na">filename=</span><span class="s">"C:\Users\C.Smith\Desktop\todo.txt"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/History&gt;</span>
<span class="nt">&lt;/NotepadPlus&gt;</span>
</pre></table></code></div></div><p><code class="highlighter-rouge">RU_config.xml</code></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;ConfigFile</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Port&gt;</span>389<span class="nt">&lt;/Port&gt;</span>
  <span class="nt">&lt;Username&gt;</span>c.smith<span class="nt">&lt;/Username&gt;</span>
  <span class="nt">&lt;Password&gt;</span>fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=<span class="nt">&lt;/Password&gt;</span>
<span class="nt">&lt;/ConfigFile&gt;</span>
</pre></table></code></div></div><p>Well , i got a new path: <code class="highlighter-rouge">&lt;File filename="\\HTB-NEST\Secure$\IT\Carl\Temp.txt" /&gt;</code> additionally a new encrypted password: <code class="highlighter-rouge">fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=</code><br /> Enumerating this new path:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>smbclient //10.10.10.178/Secure$ -U TempUser
cd \IT\Carl\
</pre></table></code></div></div><p>Now , after enumerating , i found a visual studio project in <code class="highlighter-rouge">\IT\Carl\VB Projects\WIP\RU\</code> .<br /> I enabled the recursive mode to dump the folders …</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>cd "\IT\Carl\VB Projects\WIP\RU\"
recurse on
lcd /root/Desktop/hacktheboxmachine/nest/project
mget *
</pre></table></code></div></div><p>It’s time to check the <code class="highlighter-rouge">sln</code> project with <code class="highlighter-rouge">visual studio</code> .<br /></p><p>Open the file with visual studio.<br /> After analyzing the code , The <code class="highlighter-rouge">Utils.vb</code> contain the encryption and decryption functions.<br /></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
</pre><td class="rouge-code"><pre>Imports System.Text
Imports System.Security.Cryptography
Public Class Utils

    Public Shared Function GetLogFilePath() As String
        Return IO.Path.Combine(Environment.CurrentDirectory, "Log.txt")
    End Function




    Public Shared Function DecryptString(EncryptedString As String) As String
        If String.IsNullOrEmpty(EncryptedString) Then
            Return String.Empty
        Else
            Return Decrypt(EncryptedString, "N3st22", "88552299", 2, "464R5DFA5DL6LE28", 256)
        End If
    End Function

    Public Shared Function EncryptString(PlainString As String) As String
        If String.IsNullOrEmpty(PlainString) Then
            Return String.Empty
        Else
            Return Encrypt(PlainString, "N3st22", "88552299", 2, "464R5DFA5DL6LE28", 256)
        End If
    End Function

    Public Shared Function Encrypt(ByVal plainText As String,
                                   ByVal passPhrase As String,
                                   ByVal saltValue As String,
                                    ByVal passwordIterations As Integer,
                                   ByVal initVector As String,
                                   ByVal keySize As Integer) _
                           As String

        Dim initVectorBytes As Byte() = Encoding.ASCII.GetBytes(initVector)
        Dim saltValueBytes As Byte() = Encoding.ASCII.GetBytes(saltValue)
        Dim plainTextBytes As Byte() = Encoding.ASCII.GetBytes(plainText)
        Dim password As New Rfc2898DeriveBytes(passPhrase,
                                           saltValueBytes,
                                           passwordIterations)
        Dim keyBytes As Byte() = password.GetBytes(CInt(keySize / 8))
        Dim symmetricKey As New AesCryptoServiceProvider
        symmetricKey.Mode = CipherMode.CBC
        Dim encryptor As ICryptoTransform = symmetricKey.CreateEncryptor(keyBytes, initVectorBytes)
        Using memoryStream As New IO.MemoryStream()
            Using cryptoStream As New CryptoStream(memoryStream,
                                            encryptor,
                                            CryptoStreamMode.Write)
                cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length)
                cryptoStream.FlushFinalBlock()
                Dim cipherTextBytes As Byte() = memoryStream.ToArray()
                memoryStream.Close()
                cryptoStream.Close()
                Return Convert.ToBase64String(cipherTextBytes)
            End Using
        End Using
    End Function

    Public Shared Function Decrypt(ByVal cipherText As String,
                                   ByVal passPhrase As String,
                                   ByVal saltValue As String,
                                    ByVal passwordIterations As Integer,
                                   ByVal initVector As String,
                                   ByVal keySize As Integer) _
                           As String

        Dim initVectorBytes As Byte()
        initVectorBytes = Encoding.ASCII.GetBytes(initVector)

        Dim saltValueBytes As Byte()
        saltValueBytes = Encoding.ASCII.GetBytes(saltValue)

        Dim cipherTextBytes As Byte()
        cipherTextBytes = Convert.FromBase64String(cipherText)

        Dim password As New Rfc2898DeriveBytes(passPhrase,
                                           saltValueBytes,
                                           passwordIterations)

        Dim keyBytes As Byte()
        keyBytes = password.GetBytes(CInt(keySize / 8))

        Dim symmetricKey As New AesCryptoServiceProvider
        symmetricKey.Mode = CipherMode.CBC

        Dim decryptor As ICryptoTransform
        decryptor = symmetricKey.CreateDecryptor(keyBytes, initVectorBytes)

        Dim memoryStream As IO.MemoryStream
        memoryStream = New IO.MemoryStream(cipherTextBytes)

        Dim cryptoStream As CryptoStream
        cryptoStream = New CryptoStream(memoryStream,
                                        decryptor,
                                        CryptoStreamMode.Read)

        Dim plainTextBytes As Byte()
        ReDim plainTextBytes(cipherTextBytes.Length)

        Dim decryptedByteCount As Integer
        decryptedByteCount = cryptoStream.Read(plainTextBytes,
                                               0,
                                               plainTextBytes.Length)

        memoryStream.Close()
        cryptoStream.Close()

        Dim plainText As String
        plainText = Encoding.ASCII.GetString(plainTextBytes,
                                            0,
                                            decryptedByteCount)

        Return plainText
    End Function






End Class
</pre></table></code></div></div><p>and the <code class="highlighter-rouge">module1</code> is the main function</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Sub Main()
        Dim Config As ConfigFile = ConfigFile.LoadFromFile("RU_Config.xml")
        Dim test As New SsoIntegration With {.Username = Config.Username, .Password = Utils.DecryptString(Config.Password)}



    End Sub
</pre></table></code></div></div><p>The code is trying to open the <code class="highlighter-rouge">RU_Config.xml</code> that has the password , so i will give it the password directly as input, <br /> Then call the <code class="highlighter-rouge">DecryptString</code> function from <code class="highlighter-rouge">Utils</code> file and print the result to the console. <br /> After editing , the <code class="highlighter-rouge">Module1</code> should contain the following code</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Module Module1

    Sub Main()
        ' Dim Config As ConfigFile = ConfigFile.LoadFromFile("RU_Config.xml")
        'Dim test As New SsoIntegration With {.Username = Config.Username, .Password = Utils.DecryptString(Config.Password)}
        Dim encrypted As String = "fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE="
        Dim decrypted As String = Utils.DecryptString(encrypted)
        Console.WriteLine(decrypted)
    End Sub

End Module
</pre></table></code></div></div><p>I got this output</p><p><img class="lozad" src= /assets/img/commons/loading.png data-src="https://raw.githubusercontent.com/0xyassine/0xyassine.github.io/master/assets/img/htb/nest/first.jpg" alt="info" /></p><h2 id="own-user">Own user</h2><p>So now i have the decrypted password : <code class="highlighter-rouge">xRxRxPANCAK3SxRxRx</code> <br /> To find the user , we have a <code class="highlighter-rouge">Users</code> share folder</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smbclient //10.10.10.178/Users
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/hacktheboxmachine/nest# smbclient  //10.10.10.178/Users
Enter WORKGROUP\root's password: 
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Sun Jan 26 01:04:21 2020
  ..                                  D        0  Sun Jan 26 01:04:21 2020
  Administrator                       D        0  Fri Aug  9 18:08:23 2019
  C.Smith                             D        0  Sun Jan 26 09:21:44 2020
  L.Frost                             D        0  Thu Aug  8 20:03:01 2019
  R.Thompson                          D        0  Thu Aug  8 20:02:50 2019
  TempUser                            D        0  Thu Aug  8 01:55:56 2019

    10485247 blocks of size 4096. 6545666 blocks available
smb: \&gt; 
</pre></table></code></div></div><p>The password should be for one of these users. <br /> I successfully logged in using <code class="highlighter-rouge">C.Smith</code></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smbclient  //10.10.10.178/Users -U C.Smith
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/hacktheboxmachine/nest# smbclient  //10.10.10.178/Users -U C.Smith
Enter WORKGROUP\C.Smith's password: 
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Sun Jan 26 01:04:21 2020
  ..                                  D        0  Sun Jan 26 01:04:21 2020
  Administrator                       D        0  Fri Aug  9 18:08:23 2019
  C.Smith                             D        0  Sun Jan 26 09:21:44 2020
  L.Frost                             D        0  Thu Aug  8 20:03:01 2019
  R.Thompson                          D        0  Thu Aug  8 20:02:50 2019
  TempUser                            D        0  Thu Aug  8 01:55:56 2019

    10485247 blocks of size 4096. 6545666 blocks available
smb: \&gt; cd C.Smith\
smb: \C.Smith\&gt; ls
  .                                   D        0  Sun Jan 26 09:21:44 2020
  ..                                  D        0  Sun Jan 26 09:21:44 2020
  HQK Reporting                       D        0  Fri Aug  9 02:06:17 2019
  user.txt                            A       32  Fri Aug  9 02:05:24 2019

    10485247 blocks of size 4096. 6545666 blocks available
smb: \C.Smith\&gt; 
</pre></table></code></div></div><p>User owned !</p><h2 id="own-root">Own root</h2><p>From <code class="highlighter-rouge">C.Smith/HQK Reporting</code> there is a file called <code class="highlighter-rouge">Debug Mode Password.txt</code> and <code class="highlighter-rouge">HQK_Config_Backup.xml</code></p><p><code class="highlighter-rouge">HQK_Config_Backup.xml</code>:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;ServiceSettings</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Port&gt;</span>4386<span class="nt">&lt;/Port&gt;</span>
  <span class="nt">&lt;QueryDirectory&gt;</span>C:\Program Files\HQK\ALL QUERIES<span class="nt">&lt;/QueryDirectory&gt;</span>
<span class="nt">&lt;/ServiceSettings&gt;</span>
</pre></table></code></div></div><p>Unfortunately , the <code class="highlighter-rouge">Debug Mode Password.txt</code> size is 0 <br /> I used <code class="highlighter-rouge">telnet</code> to connect to <code class="highlighter-rouge">4386</code> port</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>telnet 10.10.10.178 4386
</pre></table></code></div></div><p>After enumeration , i found a ldap config file</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>setdir ../
setdir LDAP
LIST 
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>&gt;LIST

Use the query ID numbers below with the RUNQUERY command and the directory names with the SETDIR command

 QUERY FILES IN CURRENT DIRECTORY

[1]   HqkLdap.exe
[2]   Ldap.conf

Current Directory: LDAP
&gt;
</pre></table></code></div></div><p>to read the content of this config file , we need to enable the debugging mode that require a password .<br /> After doing some researches , i found a way to read the file using <a href="https://davidhamann.de/2019/02/23/hidden-in-plain-sight-alternate-data-streams/">powershell</a> , so i used windows <br /></p><p>Add a new share and navigate to <code class="highlighter-rouge">C.Smith/HQK Reporting</code> then run:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Get-Item ".\Debug Mode Password.txt" -Stream *
Get-Content ".\Debug Mode Password.txt" -Stream Password
</pre></table></code></div></div><p><img class="lozad" src= /assets/img/commons/loading.png data-src="https://raw.githubusercontent.com/0xyassine/0xyassine.github.io/master/assets/img/htb/nest/pow.jpg" alt="info" /></p><p>I got : <code class="highlighter-rouge">WBQ201953D8w</code> as debugging password <br /> Now it’s time to read the <code class="highlighter-rouge">ldap.conf</code></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>DEBUG WBQ201953D8w
SHOWQUERY 2
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>&gt;DEBUG WBQ201953D8w

Debug mode enabled. Use the HELP command to view additional commands that are now available
&gt;help

This service allows users to run queries against databases using the legacy HQK format

--- AVAILABLE COMMANDS ---

LIST
SETDIR &lt;Directory_Name&gt;
RUNQUERY &lt;Query_ID&gt;
DEBUG &lt;Password&gt;
HELP &lt;Command&gt;
SERVICE
SESSION
SHOWQUERY &lt;Query_ID&gt;

&gt;SHOWQUERY 2

Domain=nest.local
Port=389
BaseOu=OU=WBQ Users,OU=Production,DC=nest,DC=local
User=Administrator
Password=yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=
</pre></table></code></div></div><p>Perfect , i got the <code class="highlighter-rouge">Administrator</code> password : <code class="highlighter-rouge">yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=</code> <br /> Go back to decrypt it with visual studio <br /> As i did before , i just replaced the old encrypted password with this new one</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Module Module1

    Sub Main()
        ' Dim Config As ConfigFile = ConfigFile.LoadFromFile("RU_Config.xml")
        'Dim test As New SsoIntegration With {.Username = Config.Username, .Password = Utils.DecryptString(Config.Password)}
        Dim encrypted As String = "yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4="
        Dim decrypted As String = Utils.DecryptString(encrypted)
        Console.WriteLine(decrypted)
    End Sub

End Module
</pre></table></code></div></div><p>But this time , i got a padding error in the <code class="highlighter-rouge">Utils.vb</code><br /> This error occur when the key used for encryption and decryption is wrong <br /> So now i need to find a new key <br /> I enumerated more in <code class="highlighter-rouge">C.Smith</code> user and found a <code class="highlighter-rouge">.exe</code> file under <code class="highlighter-rouge">\C.Smith\HQK Reporting\AD Integration Module</code> <br /> Reverse this file whith <code class="highlighter-rouge">dotPeek</code></p><p><img class="lozad" src= /assets/img/commons/loading.png data-src="https://raw.githubusercontent.com/0xyassine/0xyassine.github.io/master/assets/img/htb/nest/key.jpg" alt="info" /></p><p>I was able to find new parameters</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>public class CR
  {
    private const string K = "667912";
    private const string I = "1L1SA61493DRV53Z";
    private const string SA = "1313Rf99";
like this in the vb code:
Public Shared Function DecryptString(EncryptedString As String) As String
        If String.IsNullOrEmpty(EncryptedString) Then
            Return String.Empty
        Else
            'Return Decrypt(EncryptedString, "N3st22", "88552299", 2, "464R5DFA5DL6LE28", 254)
            Return Decrypt(EncryptedString, "667912", "1313Rf99", 3, "1L1SA61493DRV53Z", 256)
        End If
    End Function
</pre></table></code></div></div><p>Finally edit the <code class="highlighter-rouge">Utils.vb</code></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
</pre><td class="rouge-code"><pre>Public Class Utils

    Public Shared Function GetLogFilePath() As String
        Return IO.Path.Combine(Environment.CurrentDirectory, "Log.txt")
    End Function




    Public Shared Function DecryptString(EncryptedString As String) As String
        If String.IsNullOrEmpty(EncryptedString) Then
            Return String.Empty
        Else
            Return Decrypt(EncryptedString, "667912", "1313Rf99", 3, "1L1SA61493DRV53Z", 256)
        End If
    End Function

    Public Shared Function EncryptString(PlainString As String) As String
        If String.IsNullOrEmpty(PlainString) Then
            Return String.Empty
        Else
            Return Encrypt(PlainString, "N3st22", "88552299", 2, "464R5DFA5DL6LE28", 256)
        End If
    End Function

    Public Shared Function Encrypt(ByVal plainText As String,
                                   ByVal passPhrase As String,
                                   ByVal saltValue As String,
                                    ByVal passwordIterations As Integer,
                                   ByVal initVector As String,
                                   ByVal keySize As Integer) _
                           As String

        Dim initVectorBytes As Byte() = Encoding.ASCII.GetBytes(initVector)
        Dim saltValueBytes As Byte() = Encoding.ASCII.GetBytes(saltValue)
        Dim plainTextBytes As Byte() = Encoding.ASCII.GetBytes(plainText)
        Dim password As New Rfc2898DeriveBytes(passPhrase,
                                           saltValueBytes,
                                           passwordIterations)
        Dim keyBytes As Byte() = password.GetBytes(CInt(keySize / 8))
        Dim symmetricKey As New AesCryptoServiceProvider
        symmetricKey.Mode = CipherMode.CBC
        Dim encryptor As ICryptoTransform = symmetricKey.CreateEncryptor(keyBytes, initVectorBytes)
        Using memoryStream As New IO.MemoryStream()
            Using cryptoStream As New CryptoStream(memoryStream,
                                            encryptor,
                                            CryptoStreamMode.Write)
                cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length)
                cryptoStream.FlushFinalBlock()
                Dim cipherTextBytes As Byte() = memoryStream.ToArray()
                memoryStream.Close()
                cryptoStream.Close()
                Return Convert.ToBase64String(cipherTextBytes)
            End Using
        End Using
    End Function

    Public Shared Function Decrypt(ByVal cipherText As String,
                                   ByVal passPhrase As String,
                                   ByVal saltValue As String,
                                    ByVal passwordIterations As Integer,
                                   ByVal initVector As String,
                                   ByVal keySize As Integer) _
                           As String

        Dim initVectorBytes As Byte()
        initVectorBytes = Encoding.ASCII.GetBytes(initVector)

        Dim saltValueBytes As Byte()
        saltValueBytes = Encoding.ASCII.GetBytes(saltValue)

        Dim cipherTextBytes As Byte()
        cipherTextBytes = Convert.FromBase64String(cipherText)

        Dim password As New Rfc2898DeriveBytes(passPhrase,
                                           saltValueBytes,
                                           passwordIterations)

        Dim keyBytes As Byte()
        keyBytes = password.GetBytes(CInt(keySize / 8))

        Dim symmetricKey As New AesCryptoServiceProvider
        symmetricKey.Mode = CipherMode.CBC

        Dim decryptor As ICryptoTransform
        decryptor = symmetricKey.CreateDecryptor(keyBytes, initVectorBytes)

        Dim memoryStream As IO.MemoryStream
        memoryStream = New IO.MemoryStream(cipherTextBytes)

        Dim cryptoStream As CryptoStream
        cryptoStream = New CryptoStream(memoryStream,
                                        decryptor,
                                        CryptoStreamMode.Read)

        Dim plainTextBytes As Byte()
        ReDim plainTextBytes(cipherTextBytes.Length)

        Dim decryptedByteCount As Integer
        decryptedByteCount = cryptoStream.Read(plainTextBytes,
                                               0,
                                               plainTextBytes.Length)

        memoryStream.Close()
        cryptoStream.Close()

        Dim plainText As String
        plainText = Encoding.ASCII.GetString(plainTextBytes,
                                            0,
                                            decryptedByteCount)

        Return plainText
    End Function


End Class
</pre></table></code></div></div><p><img class="lozad" src= /assets/img/commons/loading.png data-src="https://raw.githubusercontent.com/0xyassine/0xyassine.github.io/master/assets/img/htb/nest/pass.jpg" alt="info" /></p><p>Got the admin password: <code class="highlighter-rouge">XtH4nkS4Pl4y1nGX</code></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smbclient //10.10.10.178/users -U administrator
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>root@kali:~/Desktop/hacktheboxmachine# smbclient //10.10.10.178/users -U administrator
Enter WORKGROUP\administrator's password: 
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Sun Jan 26 01:04:21 2020
  ..                                  D        0  Sun Jan 26 01:04:21 2020
  Administrator                       D        0  Fri Aug  9 18:08:23 2019
  C.Smith                             D        0  Sun Jan 26 09:21:44 2020
  L.Frost                             D        0  Thu Aug  8 20:03:01 2019
  R.Thompson                          D        0  Thu Aug  8 20:02:50 2019
  TempUser                            D        0  Thu Aug  8 01:55:56 2019

    10485247 blocks of size 4096. 6545650 blocks available
smb: \&gt; cd Administrator
smb: \Administrator\&gt; ls
  .                                   D        0  Fri Aug  9 18:08:23 2019
  ..                                  D        0  Fri Aug  9 18:08:23 2019
  flag.txt - Shortcut.lnk             A     2384  Fri Aug  9 18:10:15 2019

    10485247 blocks of size 4096. 6545650 blocks available
</pre></table></code></div></div><p>Rooted :) Your feedback is appreciated</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>Hackthebox</a>, <a href='/categories/retired/'>retired</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/smbclient/" class="post-tag no-text-decoration" >smbclient</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Nest - yassine&url=https://0xyassine.github.io//posts/nest/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Nest - yassine&u=https://0xyassine.github.io//posts/nest/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Nest - yassine&url=https://0xyassine.github.io//posts/nest/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/traceback/">Traceback</a></li><li><a href="/posts/cache/">Cache</a></li><li><a href="/posts/admirer/">Admirer</a></li><li><a href="/posts/Quick/">Quick</a></li><li><a href="/posts/ForwardSlash/">ForwardSlash</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/web-shell/">web shell</a> <a class="post-tag" href="/tags/sqlmap/">sqlmap</a> <a class="post-tag" href="/tags/smbclient/">smbclient</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/microsoft-azure/">microsoft azure</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/gtfobins/">gtfobins</a> <a class="post-tag" href="/tags/docker/">docker</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/resolute/" class="btn btn-outline-primary"><p>Resolute</p></a> <a href="/posts/monteverde/" class="btn btn-outline-primary"><p>Monteverde</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-4"><p class="font-italic text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//0xyassine.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://0xyassine.github.io//posts/nest/'; this.page.identifier = '/posts/nest/'; } }; $.disqusLoader('#disqus', options); </script> <!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/openadmin/"><div class="card-body"> <span class="timeago small"> May 1, 2020 <i class="unloaded">2020-05-01T00:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OpenAdmin</h3><div class="text-muted small"><p>OpenAdmin from HackTheBox OpenAdmin was retired .It was easy and fun box with web attack and priv escalation techniques so let’s start … nmap scan: 1 nmap -sV -sC 10.10.10.171 -v 1 2 3 4 5...</p></div></div></a></div><div class="card"> <a href="/posts/obscurity/"><div class="card-body"> <span class="timeago small"> May 8, 2020 <i class="unloaded">2020-05-08T00:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Obscurity</h3><div class="text-muted small"><p>Obscurity from HackTheBox Obscurity was retired . It was a Good box with a lot of python auditing … nmap scan 1 nmap -sV -sC -v 10.10.10.168 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19...</p></div></div></a></div><div class="card"> <a href="/posts/ForwardSlash/"><div class="card-body"> <span class="timeago small"> May 9, 2020 <i class="unloaded">2020-05-09T00:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ForwardSlash</h3><div class="text-muted small"><p>ForwardSlash from HackTheBox Good box with new bypassing techniques and simple cryto … Note : add forwardslash.htb to your hosts file nmap scan 1 nmap -sV -sC forwardslash.htb -v 1 2 ...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const observer = lozad(); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://www.facebook.com/mouhamed.yassin.90">Mohammad YASSINE</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted">Trending Tags</h4><!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/web-shell/">web shell</a> <a class="post-tag" href="/tags/sqlmap/">sqlmap</a> <a class="post-tag" href="/tags/smbclient/">smbclient</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/microsoft-azure/">microsoft azure</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/gtfobins/">gtfobins</a> <a class="post-tag" href="/tags/docker/">docker</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://0xyassine.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
